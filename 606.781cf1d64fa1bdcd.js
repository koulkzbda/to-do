"use strict";(self.webpackChunkto_do_elum=self.webpackChunkto_do_elum||[]).push([[606],{3606:(mt,x,r)=>{r.r(x),r.d(x,{HomeModule:()=>pt});var J=r(579),u=r(9808),c=r(3075),H=r(520),t=r(5e3);let Y=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[u.ez,c.u5,c.UX,H.JF,J.q],u.ez,c.u5,c.UX,H.JF,J.q]}),e})();var C=r(4100);const O=[{id:"1",title:"Inventory",content:"",done:!0,priority:0,createdAt:new Date(2022,9,9),updatedAt:new Date(2022,9,9),doneAt:new Date(2022,9,10),hidden:!1},{id:"2",title:"Review stock issue",content:"",done:!1,priority:1,createdAt:new Date(2022,9,10),updatedAt:new Date(2022,9,10),hidden:!1},{id:"3",title:"Review RSF",content:"Investigate reliability of schedules and forecasts KPI",done:!1,priority:2,createdAt:new Date(2022,9,10),updatedAt:new Date(2022,9,10),hidden:!1}];var m=r(9646),f=r(4825),v=r(8505),Q=r(1135);let B=(()=>{class e{constructor(){this.todos=new Q.X([]),this.todos$=this.todos.asObservable()}get currentTodos(){return this.todos.value}setTodos(o){this.todos.next([...o])}addTodo(o){this.todos.next([...this.todos.value,o])}removeTodo(o){var n,i;this.todos.next([...null===(i=null===(n=this.todos)||void 0===n?void 0:n.value)||void 0===i?void 0:i.filter(a=>a.id!==o.id)])}replaceTodo(o){var n,i;this.todos.next([...null===(i=null===(n=this.todos)||void 0===n?void 0:n.value)||void 0===i?void 0:i.filter(a=>a.id!==o.id),o])}updateNotDoneTodos(o){var n;this.todos.next([...null===(n=this.todos.value)||void 0===n?void 0:n.filter(i=>i.done),...o])}}return e.\u0275fac=function(o){return new(o||e)},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),k=(()=>{class e{constructor(o){this.state=o}getTodos(){return(0,m.of)(O).pipe((0,f.g)(400),(0,v.b)(o=>this.state.setTodos(o)))}updateTodoStatus(o,n){const i=Object.assign(Object.assign({},n),{done:o,updatedAt:new Date,doneAt:o?new Date:null});return(0,m.of)(i).pipe((0,f.g)(400),(0,v.b)(a=>this.state.replaceTodo(a)))}updateTodo(o,n){const i=Object.assign(Object.assign(Object.assign({},n),o),{updatedAt:new Date});return(0,m.of)(i).pipe((0,f.g)(400),(0,v.b)(a=>this.state.replaceTodo(a)))}addTodo(o){const n=Math.random().toString(36).slice(2,7),i=Object.assign(Object.assign({},o),{id:n,done:!1,updatedAt:new Date,createdAt:new Date,hidden:!1});return(0,m.of)(i).pipe((0,f.g)(400),(0,v.b)(a=>this.state.addTodo(a)))}updateNotDoneTodosPriority(o){const n=o.filter(i=>!i.done);return(0,m.of)(n).pipe((0,f.g)(400),(0,v.b)(i=>this.state.updateNotDoneTodos(i)))}updateHiddenTodo(o,n){const i=Object.assign(Object.assign({},o),{hidden:n,updatedAt:new Date});return(0,m.of)(i).pipe((0,f.g)(400),(0,v.b)(a=>this.state.replaceTodo(a)))}deleteTodo(o){return(0,m.of)(o).pipe((0,f.g)(400),(0,v.b)(n=>this.state.removeTodo(n)))}}return e.\u0275fac=function(o){return new(o||e)(t.LFG(B))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var D=r(9224),N=r(7322),P=r(7531),y=r(7423);function j(e,d){1&e&&(t.TgZ(0,"mat-error",8),t._uU(1,"Please provide a title "),t.qZA())}let U=(()=>{class e{constructor(o,n,i){this.fb=o,this.router=n,this.todoService=i}get title(){return this.form.get("title")}ngOnInit(){var o,n;const i=history.state;this.cardTitle=i.cardTitle,this.cardSubTitle=i.cardSubTitle,this.todo=null!==(o=i.todo)&&void 0!==o?o:null,this.initForm(null!==(n=i.todo)&&void 0!==n?n:null)}save(){this.form.invalid||(this.todo?this.todoService.updateTodo(this.form.value,this.todo):this.todoService.addTodo(this.form.value)).subscribe(n=>this.cancel())}cancel(){this.router.navigate(["/app"])}initForm(o){var n,i;this.form=this.fb.group({title:[null!==(n=null==o?void 0:o.title)&&void 0!==n?n:"",[c.kI.required]],content:null!==(i=null==o?void 0:o.content)&&void 0!==i?i:""})}}return e.\u0275fac=function(o){return new(o||e)(t.Y36(c.qu),t.Y36(C.F0),t.Y36(k))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-todo-form"]],decls:17,vars:5,consts:[[1,"card-container"],[3,"formGroup"],["data-testid","title","matInput","","placeholder","Title","formControlName","title"],["data-testid","error-title-required",4,"ngIf"],["data-testid","content","matInput","","placeholder","Description","formControlName","content"],["align","end"],["mat-button","","data-testid","cancel",3,"click"],["mat-button","","data-testid","save",3,"disabled","click"],["data-testid","error-title-required"]],template:function(o,n){1&o&&(t.TgZ(0,"div",0)(1,"mat-card")(2,"mat-card-title"),t._uU(3),t.qZA(),t.TgZ(4,"mat-card-subtitle"),t._uU(5),t.qZA(),t.TgZ(6,"mat-card-content",1)(7,"mat-form-field"),t._UZ(8,"input",2),t.YNc(9,j,2,0,"mat-error",3),t.qZA(),t.TgZ(10,"mat-form-field"),t._UZ(11,"textarea",4),t.qZA()(),t.TgZ(12,"mat-card-actions",5)(13,"button",6),t.NdJ("click",function(){return n.cancel()}),t._uU(14,"CANCEL"),t.qZA(),t.TgZ(15,"button",7),t.NdJ("click",function(){return n.save()}),t._uU(16,"SAVE"),t.qZA()()()()),2&o&&(t.xp6(3),t.Oqu(n.cardTitle),t.xp6(2),t.Oqu(n.cardSubTitle),t.xp6(1),t.Q6J("formGroup",n.form),t.xp6(3),t.Q6J("ngIf",null==n.title.errors?null:n.title.errors.required),t.xp6(6),t.Q6J("disabled",n.form.invalid||n.form.untouched))},directives:[D.a8,D.n5,D.$j,D.dn,c.JL,c.sg,N.KE,P.Nt,c.Fj,c.JJ,c.u,u.O5,N.TO,D.hq,y.lW],styles:["mat-form-field[_ngcontent-%COMP%]{width:100%}.card-container[_ngcontent-%COMP%]{width:100%;display:flex;margin-top:2rem}mat-card[_ngcontent-%COMP%]{width:400px;max-width:90vw;margin:auto}"]}),e})();var S=r(4004),q=r(7579),$=r(9300);let w=(()=>{class e{constructor(){this.emitter$=new q.x}emit(o){this.emitter$.next(o)}on(o,n){return this.emitter$.pipe((0,$.h)(i=>i.name===o),(0,S.U)(i=>i.value)).subscribe(n)}}return e.\u0275fac=function(o){return new(o||e)},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var L=r(5698),_=r(8966);let R=(()=>{class e{constructor(o,n){this.data=o,this.dialogRef=n}onEsc(){this.close(!1)}cancel(){this.close(!1)}close(o){this.dialogRef.close(o)}confirm(){this.close(!0)}}return e.\u0275fac=function(o){return new(o||e)(t.Y36(_.WI),t.Y36(_.so))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-confirm-dialog"]],hostBindings:function(o,n){1&o&&t.NdJ("keydown.esc",function(){return n.onEsc()})},decls:10,vars:4,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["mat-dialog-actions",""],["mat-button","",3,"click"],["mat-button","","cdkFocusInitial","",3,"click"]],template:function(o,n){1&o&&(t.TgZ(0,"h1",0),t._uU(1),t.qZA(),t.TgZ(2,"div",1)(3,"p"),t._uU(4),t.qZA()(),t.TgZ(5,"div",2)(6,"button",3),t.NdJ("click",function(){return n.cancel()}),t._uU(7),t.qZA(),t.TgZ(8,"button",4),t.NdJ("click",function(){return n.confirm()}),t._uU(9),t.qZA()()),2&o&&(t.xp6(1),t.Oqu(n.data.title),t.xp6(3),t.Oqu(n.data.message),t.xp6(3),t.Oqu(n.data.cancelText),t.xp6(2),t.Oqu(n.data.confirmText))},directives:[_.uh,_.xY,_.H8,y.lW],styles:[""]}),e})(),z=(()=>{class e{constructor(o){this.dialog=o}open(o){this.dialogRef=this.dialog.open(R,{data:{title:o.title,message:o.message,cancelText:o.cancelText,confirmText:o.confirmText}})}confirmed(){return this.dialogRef.afterClosed().pipe((0,L.q)(1),(0,S.U)(o=>o))}}return e.\u0275fac=function(o){return new(o||e)(t.LFG(_.uw))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var E=r(3251),I=r(3737),A=r(9451);class Z{constructor(d,o){this.name=d,this.value=o}}var X=r(7446);let W=(()=>{class e{constructor(){}onClick(o){o.stopPropagation()}onTouchMmove(o){o.stopPropagation()}onTouchStart(o){o.stopPropagation()}onTouchEnd(o){o.stopPropagation()}onMouseDown(o){o.stopPropagation()}}return e.\u0275fac=function(o){return new(o||e)},e.\u0275dir=t.lG2({type:e,selectors:[["","appStopClick",""]],hostBindings:function(o,n){1&o&&t.NdJ("click",function(a){return n.onClick(a)})("touchmove",function(a){return n.onTouchMmove(a)})("touchstart",function(a){return n.onTouchStart(a)})("touchend",function(a){return n.onTouchEnd(a)})("mousedown",function(a){return n.onMouseDown(a)})}}),e})();var F=r(2181),M=r(5245);function G(e,d){if(1&e){const o=t.EpF();t.TgZ(0,"button",8),t.NdJ("click",function(){t.CHM(o);const i=t.oxw();return i.archive(i.todo)}),t._uU(1," Archive "),t.qZA()}}function K(e,d){if(1&e){const o=t.EpF();t.TgZ(0,"button",8),t.NdJ("click",function(){t.CHM(o);const i=t.oxw();return i.restore(i.todo)}),t._uU(1," Restore "),t.qZA()}}function V(e,d){if(1&e){const o=t.EpF();t.TgZ(0,"button",8),t.NdJ("click",function(){t.CHM(o);const i=t.oxw();return i.remove(i.todo)}),t._uU(1," Delete "),t.qZA()}}let tt=(()=>{class e{constructor(o,n){this.eventBus=o,this.router=n}updateTodoStatus(o,n){this.eventBus.emit(new Z("updateTodoStatus",{done:o,todo:n}))}archive(o){this.eventBus.emit(new Z("archiveTodo",o))}restore(o){this.eventBus.emit(new Z("restoreTodo",o))}remove(o){this.eventBus.emit(new Z("removeTodo",o))}goToUpdate(o){this.router.navigate(["app","update"],{state:{cardTitle:"Edit task",cardSubTitle:"What are you planning to do ?",todo:o}})}}return e.\u0275fac=function(o){return new(o||e)(t.Y36(w),t.Y36(C.F0))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-to-do-item"]],inputs:{todo:"todo"},decls:18,vars:10,consts:[[3,"hideToggle"],["appStopClick","",3,"checked","disabled","change"],["mat-icon-button","","appStopClick","",1,"align-end",3,"matMenuTriggerFor"],["data-testid","content"],["appStopClick",""],["menu","matMenu"],["mat-menu-item","",3,"disabled","click"],["mat-menu-item","",3,"click",4,"ngIf"],["mat-menu-item","",3,"click"]],template:function(o,n){if(1&o&&(t.TgZ(0,"mat-expansion-panel",0)(1,"mat-expansion-panel-header")(2,"mat-panel-title")(3,"mat-checkbox",1),t.NdJ("change",function(a){return n.updateTodoStatus(a.checked,n.todo)}),t._uU(4),t.qZA()(),t.TgZ(5,"mat-panel-description")(6,"button",2)(7,"mat-icon"),t._uU(8,"more_horiz"),t.qZA()()()(),t.TgZ(9,"p",3),t._uU(10),t.qZA()(),t.TgZ(11,"mat-menu",4,5)(13,"button",6),t.NdJ("click",function(){return n.goToUpdate(n.todo)}),t._uU(14," Edit "),t.qZA(),t.YNc(15,G,2,0,"button",7),t.YNc(16,K,2,0,"button",7),t.YNc(17,V,2,0,"button",7),t.qZA()),2&o){const i=t.MAs(12);t.Q6J("hideToggle",!n.todo.content),t.xp6(3),t.Q6J("checked",n.todo.done)("disabled",n.todo.hidden),t.xp6(1),t.hij(" ",n.todo.title," "),t.xp6(2),t.Q6J("matMenuTriggerFor",i),t.xp6(4),t.Oqu(n.todo.content),t.xp6(3),t.Q6J("disabled",n.todo.hidden),t.xp6(2),t.Q6J("ngIf",!n.todo.hidden),t.xp6(1),t.Q6J("ngIf",n.todo.hidden),t.xp6(1),t.Q6J("ngIf",n.todo.hidden)}},directives:[A.ib,A.yz,A.yK,X.oG,W,A.u4,y.lW,F.p6,M.Hw,F.VK,F.OP,u.O5],styles:["mat-panel-description[_ngcontent-%COMP%]{display:flex}.align-end[_ngcontent-%COMP%]{margin-left:auto}"]}),e})();function ot(e,d){if(1&e&&t._UZ(0,"app-to-do-item",4),2&e){const o=d.$implicit,n=t.oxw(2);t.Q6J("todo",o)("cdkDragDisabled",!n.dragDropEnabled)}}function et(e,d){if(1&e){const o=t.EpF();t.ynx(0),t.TgZ(1,"mat-accordion",2),t.NdJ("cdkDropListDropped",function(i){return t.CHM(o),t.oxw().drop(i)}),t.YNc(2,ot,1,2,"app-to-do-item",3),t.qZA(),t.BQk()}if(2&e){const o=t.oxw();t.xp6(1),t.Q6J("cdkDropListData",o.todos),t.xp6(1),t.Q6J("ngForOf",o.todos)}}function nt(e,d){1&e&&t.Hsn(0)}const it=["*"];let dt=(()=>{class e{constructor(o){this.todoService=o,this.todos=[],this.dragDropEnabled=!0}drop(o){var n,i;(0,I.bA)(this.todos,o.previousIndex,o.currentIndex),null===(i=null===(n=null==o?void 0:o.container)||void 0===n?void 0:n.data)||void 0===i||i.forEach((a,p)=>{var s;a.priority=p,p===this.todos.length-1&&this.todoService.updateNotDoneTodosPriority(null===(s=null==o?void 0:o.container)||void 0===s?void 0:s.data).subscribe()})}}return e.\u0275fac=function(o){return new(o||e)(t.Y36(k))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-to-do-tab"]],inputs:{todos:"todos",dragDropEnabled:"dragDropEnabled"},ngContentSelectors:it,decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["noContent",""],["data-testid","mat-accordion","cdkDropList","","multi","",3,"cdkDropListData","cdkDropListDropped"],["cdkDrag","",3,"todo","cdkDragDisabled",4,"ngFor","ngForOf"],["cdkDrag","",3,"todo","cdkDragDisabled"]],template:function(o,n){if(1&o&&(t.F$t(),t.YNc(0,et,3,2,"ng-container",0),t.YNc(1,nt,1,0,"ng-template",null,1,t.W1O)),2&o){const i=t.MAs(2);t.Q6J("ngIf",n.todos.length)("ngIfElse",i)}},directives:[u.O5,A.pp,I.Wj,u.sg,tt,I.Zt],styles:[""]}),e})(),at=(()=>{class e{constructor(o){this.router=o}goToAddTodo(){this.router.navigate(["app","add"],{state:{cardTitle:"New task",cardSubTitle:"What are you planning to do ?"}})}}return e.\u0275fac=function(o){return new(o||e)(t.Y36(C.F0))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-add-todo-button"]],decls:3,vars:0,consts:[["data-testid","add-todo-button","mat-fab","","color","accent",1,"add-button",3,"click"]],template:function(o,n){1&o&&(t.TgZ(0,"button",0),t.NdJ("click",function(){return n.goToAddTodo()}),t.TgZ(1,"mat-icon"),t._uU(2,"add"),t.qZA()())},directives:[y.lW,M.Hw],styles:[".add-button[_ngcontent-%COMP%]{position:absolute;top:calc(100% - 6rem);right:2rem}"]}),e})();function rt(e,d){1&e&&(t.TgZ(0,"app-to-do-tab",7)(1,"p",8),t._uU(2,"You're up to date, you have no tasks to be done."),t.qZA()()),2&e&&t.Q6J("todos",d.ngIf)}function st(e,d){1&e&&(t.TgZ(0,"app-to-do-tab",9)(1,"p",8),t._uU(2,"No tasks done."),t.qZA()()),2&e&&t.Q6J("todos",d.ngIf)("dragDropEnabled",!1)}function ct(e,d){1&e&&(t.TgZ(0,"app-to-do-tab",9)(1,"p",8),t._uU(2,"No tasks archived."),t.qZA()()),2&e&&t.Q6J("todos",d.ngIf)("dragDropEnabled",!1)}const lt=[{path:"",children:[{path:"",component:(()=>{class e{constructor(o,n,i,a){this.todoService=o,this.state=n,this.eventBus=i,this.dialogService=a,this.notDoneTodos$=this.state.todos$.pipe((0,S.U)(p=>p.filter(s=>!s.done&&!s.hidden).sort((s,l)=>s.priority-l.priority))),this.doneTodos$=this.state.todos$.pipe((0,S.U)(p=>p.filter(s=>s.done&&!s.hidden).sort((s,l)=>{var T,g,h,b;return null!==(g=null===(T=null==l?void 0:l.doneAt)||void 0===T?void 0:T.getTime())&&void 0!==g?g:0-(null!==(b=null===(h=null==s?void 0:s.doneAt)||void 0===h?void 0:h.getTime())&&void 0!==b?b:0)}))),this.archivedTodos$=this.state.todos$.pipe((0,S.U)(p=>p.filter(s=>s.hidden).sort((s,l)=>{var T,g,h,b;return null!==(g=null===(T=null==l?void 0:l.updatedAt)||void 0===T?void 0:T.getTime())&&void 0!==g?g:0-(null!==(b=null===(h=null==s?void 0:s.updatedAt)||void 0===h?void 0:h.getTime())&&void 0!==b?b:0)})))}ngOnInit(){var o;(null===(o=this.state.currentTodos)||void 0===o?void 0:o.length)||this.todoService.getTodos().subscribe(),this.onUpdateTodoStatus(),this.onArchiveTodo(),this.onRestoreTodo(),this.onRemoveTodo()}onUpdateTodoStatus(){this.eventBus.on("updateTodoStatus",o=>{this.todoService.updateTodoStatus(o.done,o.todo).subscribe()})}onArchiveTodo(){this.eventBus.on("archiveTodo",o=>{this.todoService.updateHiddenTodo(o,!0).subscribe()})}onRestoreTodo(){this.eventBus.on("restoreTodo",o=>{this.todoService.updateHiddenTodo(o,!1).subscribe()})}onRemoveTodo(){this.eventBus.on("removeTodo",o=>{this.dialogService.open({title:"Delete task ?",message:"By deleting permanently this task you will not be able to recover it.",cancelText:"CANCEL",confirmText:"DELETE"}),this.dialogService.confirmed().subscribe(i=>{i&&this.todoService.deleteTodo(o).subscribe()})})}}return e.\u0275fac=function(o){return new(o||e)(t.Y36(k),t.Y36(B),t.Y36(w),t.Y36(z))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-home"]],decls:12,vars:9,consts:[[1,"full-height"],["mat-align-tabs","start"],["data-testid","to-do-tab","label","To do"],[3,"todos",4,"ngIf"],["data-testid","done-tab","label","Done"],[3,"todos","dragDropEnabled",4,"ngIf"],["data-testid","archived-tab","label","Archived"],[3,"todos"],[1,"default-text"],[3,"todos","dragDropEnabled"]],template:function(o,n){1&o&&(t.TgZ(0,"div",0)(1,"mat-tab-group",1)(2,"mat-tab",2),t.YNc(3,rt,3,1,"app-to-do-tab",3),t.ALo(4,"async"),t.qZA(),t.TgZ(5,"mat-tab",4),t.YNc(6,st,3,2,"app-to-do-tab",5),t.ALo(7,"async"),t.qZA(),t.TgZ(8,"mat-tab",6),t.YNc(9,ct,3,2,"app-to-do-tab",5),t.ALo(10,"async"),t.qZA()(),t._UZ(11,"app-add-todo-button"),t.qZA()),2&o&&(t.xp6(3),t.Q6J("ngIf",t.lcZ(4,3,n.notDoneTodos$)),t.xp6(3),t.Q6J("ngIf",t.lcZ(7,5,n.doneTodos$)),t.xp6(3),t.Q6J("ngIf",t.lcZ(10,7,n.archivedTodos$)))},directives:[E.SP,E.uX,u.O5,dt,at],pipes:[u.Ov],styles:[".default-text[_ngcontent-%COMP%]{margin-left:2rem}.full-height[_ngcontent-%COMP%]{height:calc(100vh - 64px)}"]}),e})()},{path:"add",component:U},{path:"update",component:U}]}];let ut=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[C.Bz.forChild(lt)],C.Bz]}),e})(),pt=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[Y,ut]]}),e})()}}]);